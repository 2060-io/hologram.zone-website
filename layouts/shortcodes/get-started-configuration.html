{{- $data := .Page.Params.configuration -}}
{{- if not $data -}}
  {{- warnf "get-started-configuration shortcode: configuration data not provided for %s" .Page.File.Path -}}
  {{- return -}}
{{- end -}}

<section id="configuration-section" class="py-20 bg-white">
  <div class="container mx-auto px-6">
    <div class="max-w-5xl mx-auto">
      <div class="flex items-center space-x-4 mb-12">
        {{- with $data.step_number -}}
          <div class="step-number w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-xl">{{ . }}</div>
        {{- end -}}
        {{- with $data.title -}}
          <h2 class="text-4xl font-bold text-gray-900">{{ . }}</h2>
        {{- end -}}
      </div>

      {{- with $data.description -}}
        {{- partial "get-started/richtext.html" (dict
          "content" .
          "p_class" "text-lg text-gray-700 leading-relaxed mb-16"
          "a_class" "text-hologram-primary hover:text-hologram-dark font-semibold underline"
          "code_class" "px-2 py-1 bg-white rounded text-hologram-primary font-mono border border-gray-200"
        ) -}}
      {{- end -}}

      {{- with $data.cards -}}
        <div class="space-y-6 mt-12 mb-12">
          {{- range . -}}
            {{- $cardClass := .card_class | default "bg-gradient-to-br from-hologram-primary/5 to-hologram-secondary/5 border border-hologram-primary/20 rounded-xl p-8" -}}
            <div class="{{ $cardClass }}">
              <div class="flex items-start space-x-4">
                {{- $iconBg := .icon_bg | default "bg-hologram-primary" -}}
                {{- $iconColor := .icon_color | default "text-white" -}}
                <div class="w-10 h-10 {{ $iconBg }} rounded-lg flex items-center justify-center flex-shrink-0">
                  {{- with .icon -}}
                    <i class="{{ . }} {{ $iconColor }}"></i>
                  {{- end -}}
                </div>
                <div class="flex-1">
                  {{- with .title -}}
                    <h3 class="text-xl font-bold text-gray-900 mb-3">{{ . }}</h3>
                  {{- end -}}
                  {{- with .description -}}
                    {{- partial "get-started/richtext.html" (dict
                      "content" .
                      "p_class" "text-gray-700 mb-6"
                      "a_class" "text-hologram-primary hover:text-hologram-dark font-semibold underline"
                      "code_class" "px-2 py-1 bg-white rounded text-hologram-primary font-mono border border-gray-200"
                    ) -}}
                  {{- end -}}
                  {{- if or .example_label .example_code -}}
                    <div class="bg-white rounded-lg p-4 border border-gray-200 mt-6">
                      {{- with .example_label -}}
                        <p class="text-sm text-gray-600 mb-2">{{ . }}</p>
                      {{- end -}}
                      {{- with .example_code -}}
                        <code class="text-hologram-primary font-mono text-sm">{{ . }}</code>
                      {{- end -}}
                    </div>
                  {{- end -}}
                </div>
              </div>
            </div>
          {{- end -}}
        </div>
      {{- end -}}

      {{- with $data.command_block -}}
        {{- $cmdBlock := . -}}
        {{- $configCodeId := "get-started-configuration-command-code" -}}
        <div class="run-container-card rounded-2xl p-8 shadow-2xl">
          <div class="flex items-center justify-between mb-6">
            <h3 class="text-xl font-bold text-white flex items-center">
              <i class="{{ $cmdBlock.icon | default "fas fa-terminal" }} mr-3"></i>
              {{ $cmdBlock.title | default "Run the Container" }}
            </h3>
            {{- with $cmdBlock.button_label -}}
              <button type="button" class="px-4 py-2 bg-hologram-primary text-white rounded-lg hover:bg-hologram-secondary transition-colors duration-200 text-sm font-semibold inline-flex items-center" data-copy-button data-copy-target="#{{ $configCodeId }}">
                <i class="{{ $cmdBlock.button_icon | default "fas fa-copy" }} mr-2"></i>
                <span data-copy-label>{{ . }}</span>
              </button>
              {{- partial "get-started/copy-script.html" (dict "page" $.Page) -}}
            {{- end -}}
          </div>
          {{- with $cmdBlock.code -}}
            {{- $cmd := strings.TrimSpace (replace (replace . "\r\n" "\n") "\r" "\n") -}}
            <div class="bg-black rounded-lg p-6 overflow-x-auto">
              <pre class="text-green-400 text-sm font-mono leading-relaxed"><code id="{{ $configCodeId }}">{{ $cmd | htmlEscape }}</code></pre>
            </div>
          {{- end -}}
        </div>
      {{- end -}}

      {{- with $data.note -}}
        <div class="mt-8 bg-amber-50 border-l-4 border-amber-500 rounded-lg p-6">
          <div class="flex items-start space-x-4">
            {{- with .icon -}}
              <i class="{{ . }} text-amber-500 text-xl mt-1"></i>
            {{- end -}}
            <div>
              {{- with .title -}}
                <p class="text-gray-800 font-semibold mb-2">{{ . }}</p>
              {{- end -}}
              {{- with .text -}}
                {{- partial "get-started/richtext.html" (dict
                  "content" .
                  "p_class" "text-gray-700"
                  "a_class" "text-hologram-primary hover:text-hologram-dark font-semibold underline"
                  "code_class" "px-2 py-1 bg-white rounded text-hologram-primary font-mono border border-gray-200"
                ) -}}
              {{- end -}}
            </div>
          </div>
        </div>
      {{- end -}}
    </div>
  </div>
</section>
